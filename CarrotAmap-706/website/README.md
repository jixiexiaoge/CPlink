# åé¦ˆç®¡ç†ç³»ç»Ÿ

ä¸€ä¸ªåŸºäºFlaskå’ŒSQLiteçš„åé¦ˆç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒå›¾ç‰‡ä¸Šä¼ ã€ç®¡ç†å‘˜åŠŸèƒ½å’Œå“åº”å¼è®¾è®¡ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½
- **APIæ¥å£**: æ¥æ”¶æ¥è‡ªAPPçš„POSTè¯·æ±‚ï¼ŒåŒ…å«IDã€æ—¶é—´ã€åé¦ˆå†…å®¹å’Œ1-2å¼ å›¾ç‰‡
- **æ•°æ®å­˜å‚¨**: ä½¿ç”¨SQLiteæ•°æ®åº“å­˜å‚¨åé¦ˆä¿¡æ¯
- **å›¾ç‰‡ç®¡ç†**: æ”¯æŒå›¾ç‰‡ä¸Šä¼ ã€å­˜å‚¨å’Œé¢„è§ˆ
- **APKç®¡ç†**: æ”¯æŒAPKæ–‡ä»¶ä¸Šä¼ ã€ç‰ˆæœ¬ç®¡ç†å’Œè‡ªåŠ¨æ›´æ–°æ£€æŸ¥
- **å“åº”å¼è®¾è®¡**: å®Œç¾æ”¯æŒæ‰‹æœºå’Œç”µè„‘è®¿é—®

### ğŸ”§ ç®¡ç†å‘˜åŠŸèƒ½
- **èº«ä»½éªŒè¯**: ç®¡ç†å‘˜å¯†ç  `1533`
- **æ•°æ®ç®¡ç†**: åˆ é™¤åé¦ˆæ¡ç›®
- **å¤‡æ³¨åŠŸèƒ½**: ä¸ºåé¦ˆæ·»åŠ ç®¡ç†å‘˜å¤‡æ³¨
- **æ•°æ®å¯¼å‡º**: å¯¼å‡ºæ‰€æœ‰æ•°æ®ä¸ºCSVæ ¼å¼
- **å›¾ç‰‡æŸ¥çœ‹**: ç‚¹å‡»é¢„è§ˆä¸Šä¼ çš„å›¾ç‰‡
- **APKç®¡ç†**: ä¸Šä¼ ã€åˆ é™¤APKç‰ˆæœ¬ï¼Œç®¡ç†æ›´æ–°è¯´æ˜

### ğŸ“± ç”¨æˆ·ä½“éªŒ
- **ç°ä»£åŒ–ç•Œé¢**: ä½¿ç”¨Bootstrap 5æ„å»ºçš„ç¾è§‚ç•Œé¢
- **ç§»åŠ¨ç«¯ä¼˜åŒ–**: å®Œç¾é€‚é…æ‰‹æœºå’Œå¹³æ¿è®¾å¤‡
- **å®æ—¶åé¦ˆ**: æ“ä½œæˆåŠŸ/å¤±è´¥çš„å³æ—¶æç¤º
- **å›¾ç‰‡é¢„è§ˆ**: ç‚¹å‡»å›¾ç‰‡å³å¯å…¨å±æŸ¥çœ‹

## æŠ€æœ¯æ ˆ

- **åç«¯**: Flask 2.3.3
- **æ•°æ®åº“**: SQLite
- **å‰ç«¯**: Bootstrap 5 + Font Awesome
- **æ–‡ä»¶å¤„ç†**: Werkzeug
- **å“åº”å¼è®¾è®¡**: CSS3 + JavaScript

## å¿«é€Ÿå¼€å§‹

### ğŸŒ åœ¨çº¿ä½“éªŒ
- **Webç•Œé¢**: https://app.mspa.shop
- **ç®¡ç†å‘˜é¢æ¿**: https://app.mspa.shop/admin/login (å¯†ç : 1533)
- **APIæµ‹è¯•**: ä½¿ç”¨æä¾›çš„æµ‹è¯•è„šæœ¬

### ğŸ“± Androidé›†æˆ
1. **å¿«é€Ÿé›†æˆ**ï¼šä½¿ç”¨ `android_example/` æ–‡ä»¶å¤¹ä¸­çš„å®Œæ•´ç¤ºä¾‹ä»£ç 
2. **ä»£ç ç¤ºä¾‹**ï¼šå¤åˆ¶READMEä¸­çš„Androidä»£ç ç¤ºä¾‹
3. **é…ç½®æœåŠ¡å™¨**ï¼šä¿®æ”¹æœåŠ¡å™¨åœ°å€ä¸º `https://app.mspa.shop`
4. **æµ‹è¯•åŠŸèƒ½**ï¼šè¿è¡Œåº”ç”¨å¹¶æµ‹è¯•åé¦ˆæäº¤åŠŸèƒ½

> ğŸ’¡ **æç¤º**ï¼š`android_example/` æ–‡ä»¶å¤¹åŒ…å«å®Œæ•´çš„Androidé¡¹ç›®ç¤ºä¾‹ï¼ŒåŒ…æ‹¬Activityã€APIæœåŠ¡ã€å›¾ç‰‡å¤„ç†å·¥å…·ç­‰ï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶ä½¿ç”¨ã€‚

## å®‰è£…å’Œè¿è¡Œ

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰

1. åŒå‡»è¿è¡Œ `run.bat` æ–‡ä»¶
2. è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
   - æ£€æŸ¥Pythonç¯å¢ƒ
   - åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
   - å®‰è£…ä¾èµ–åŒ…
   - å¯åŠ¨Flaskåº”ç”¨

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨å®‰è£…

1. **å®‰è£…Pythonä¾èµ–**
   ```bash
   pip install -r requirements.txt
   ```

2. **è¿è¡Œåº”ç”¨**
   ```bash
   python app.py
   ```

3. **è®¿é—®åº”ç”¨**
   - æœ¬åœ°æµ‹è¯•: http://localhost:5000
   - ç”Ÿäº§ç¯å¢ƒ: https://app.mspa.shop
   - ç®¡ç†å‘˜ç™»å½•: https://app.mspa.shop/admin/login

## é¡¹ç›®ç»“æ„

```
website/
â”œâ”€â”€ app.py                 # Flaskä¸»åº”ç”¨æ–‡ä»¶
â”œâ”€â”€ requirements.txt       # Pythonä¾èµ–åŒ…
â”œâ”€â”€ run.bat               # Windowså¯åŠ¨è„šæœ¬
â”œâ”€â”€ README.md             # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ test_apk_api.py       # APKç‰ˆæœ¬APIæµ‹è¯•è„šæœ¬
â”œâ”€â”€ feedback.db           # SQLiteæ•°æ®åº“ï¼ˆè¿è¡Œåè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ uploads/              # å›¾ç‰‡ä¸Šä¼ ç›®å½•ï¼ˆè¿è¡Œåè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ templates/            # HTMLæ¨¡æ¿æ–‡ä»¶å¤¹
â”‚   â”œâ”€â”€ base.html         # åŸºç¡€æ¨¡æ¿
â”‚   â”œâ”€â”€ index.html        # ä¸»é¡µæ¨¡æ¿
â”‚   â”œâ”€â”€ admin_login.html  # ç®¡ç†å‘˜ç™»å½•é¡µé¢
â”‚   â””â”€â”€ admin_panel.html  # ç®¡ç†å‘˜é¢æ¿
â”œâ”€â”€ static/               # é™æ€æ–‡ä»¶æ–‡ä»¶å¤¹
â”‚   â”œâ”€â”€ style.css         # è‡ªå®šä¹‰æ ·å¼
â”‚   â””â”€â”€ script.js         # JavaScriptåŠŸèƒ½
â””â”€â”€ android_example/      # Androidé›†æˆç¤ºä¾‹
    â”œâ”€â”€ README.md         # Androidé›†æˆè¯´æ˜
    â”œâ”€â”€ FeedbackActivity.kt      # åé¦ˆActivity
    â”œâ”€â”€ FeedbackApiService.kt    # APIæœåŠ¡ç±»
    â”œâ”€â”€ ImageUtils.kt            # å›¾ç‰‡å¤„ç†å·¥å…·
    â”œâ”€â”€ activity_feedback.xml    # å¸ƒå±€æ–‡ä»¶
    â”œâ”€â”€ build.gradle             # ä¾èµ–é…ç½®
    â””â”€â”€ AndroidManifest.xml      # æƒé™é…ç½®
```

## APIæ¥å£è¯´æ˜

### æäº¤åé¦ˆæ¥å£

**URL**: `POST /api/feedback`

**å‚æ•°**:
- `id`: ç”¨æˆ·IDï¼ˆå­—ç¬¦ä¸²ï¼‰
- `time`: æ—¶é—´æˆ³ï¼ˆå­—ç¬¦ä¸²ï¼‰
- `feedback`: åé¦ˆå†…å®¹ï¼ˆå­—ç¬¦ä¸²ï¼‰
- `images`: å›¾ç‰‡æ–‡ä»¶ï¼ˆ1-2å¼ ï¼Œå¯é€‰ï¼‰

**å“åº”**:
```json
{
    "status": "success",
    "message": "åé¦ˆæäº¤æˆåŠŸ"
}
```

**ç¤ºä¾‹**:
```bash
# æœ¬åœ°æµ‹è¯•
curl -X POST http://localhost:5000/api/feedback \
  -F "id=user123" \
  -F "time=2024-01-01 12:00:00" \
  -F "feedback=è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•åé¦ˆ" \
  -F "images=@image1.jpg" \
  -F "images=@image2.jpg"

# ç”Ÿäº§ç¯å¢ƒ
curl -k -X POST https://app.mspa.shop/api/feedback \
  -F "id=user123" \
  -F "time=2024-01-01 12:00:00" \
  -F "feedback=è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•åé¦ˆ" \
  -F "images=@image1.jpg" \
  -F "images=@image2.jpg"
```

### APKç‰ˆæœ¬æ£€æŸ¥æ¥å£

**URL**: `GET /api/apk/version`

**è¯´æ˜**: è·å–æœ€æ–°APKç‰ˆæœ¬ä¿¡æ¯ï¼Œç”¨äºAPPè‡ªåŠ¨æ›´æ–°æ£€æŸ¥

**å“åº”**:
```json
{
    "status": "success",
    "version_code": "250909",
    "version_name": "v2.5.9",
    "update_notes": "ä¿®å¤äº†å·²çŸ¥é—®é¢˜ï¼Œä¼˜åŒ–äº†ç”¨æˆ·ä½“éªŒ",
    "download_url": "https://app.mspa.shop/apks/app_v250909_app.apk",
    "file_size": 15728640,
    "upload_time": "2024-01-01 12:00:00"
}
```

**é”™è¯¯å“åº”**:
```json
{
    "error": "æš‚æ— å¯ç”¨ç‰ˆæœ¬"
}
```

**ç¤ºä¾‹**:
```bash
# æ£€æŸ¥æœ€æ–°ç‰ˆæœ¬
curl -k https://app.mspa.shop/api/apk/version

# ä¸‹è½½APKæ–‡ä»¶
curl -k -O https://app.mspa.shop/apks/app_v250909_app.apk
```

## æ•°æ®åº“ç»“æ„

### feedbackè¡¨
| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| id | INTEGER | ä¸»é”®ï¼Œè‡ªå¢ |
| user_id | TEXT | ç”¨æˆ·ID |
| time | TEXT | åé¦ˆæ—¶é—´ |
| feedback | TEXT | åé¦ˆå†…å®¹ |
| images | TEXT | å›¾ç‰‡è·¯å¾„ï¼ˆJSONæ ¼å¼ï¼‰ |
| note | TEXT | ç®¡ç†å‘˜å¤‡æ³¨ |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ |

### apk_versionsè¡¨
| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| id | INTEGER | ä¸»é”®ï¼Œè‡ªå¢ |
| version_code | TEXT | ç‰ˆæœ¬å·ï¼ˆå¦‚250909ï¼‰ |
| version_name | TEXT | ç‰ˆæœ¬åç§°ï¼ˆå¦‚v2.5.9ï¼‰ |
| update_notes | TEXT | æ›´æ–°è¯´æ˜ |
| download_url | TEXT | APKä¸‹è½½é“¾æ¥ |
| file_size | INTEGER | æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ |
| upload_time | TIMESTAMP | æ·»åŠ æ—¶é—´ |
| is_active | BOOLEAN | æ˜¯å¦ä¸ºå½“å‰æ´»è·ƒç‰ˆæœ¬ |

## ç®¡ç†å‘˜åŠŸèƒ½è¯´æ˜

### ç™»å½•
- æœ¬åœ°æµ‹è¯•: http://localhost:5000/admin/login
- ç”Ÿäº§ç¯å¢ƒ: https://app.mspa.shop/admin/login
- å¯†ç : `1533`

### ç®¡ç†æ“ä½œ
1. **åˆ é™¤åé¦ˆ**: ç‚¹å‡»åé¦ˆæ¡ç›®å³ä¾§çš„åˆ é™¤æŒ‰é’®
2. **æ·»åŠ å¤‡æ³¨**: åœ¨å¤‡æ³¨æ¡†ä¸­è¾“å…¥å†…å®¹ï¼Œç‚¹å‡»ä¿å­˜
3. **å¯¼å‡ºæ•°æ®**: ç‚¹å‡»"å¯¼å‡ºæ•°æ®"æŒ‰é’®ä¸‹è½½CSVæ–‡ä»¶
4. **æŸ¥çœ‹å›¾ç‰‡**: ç‚¹å‡»å›¾ç‰‡ç¼©ç•¥å›¾æŸ¥çœ‹å¤§å›¾
5. **æ·»åŠ APKç‰ˆæœ¬**: ç‚¹å‡»"æ·»åŠ APKç‰ˆæœ¬"æŒ‰é’®ï¼Œå¡«å†™ç‰ˆæœ¬ä¿¡æ¯å’Œä¸‹è½½é“¾æ¥
6. **ç®¡ç†APKç‰ˆæœ¬**: æŸ¥çœ‹ã€ä¸‹è½½ã€åˆ é™¤APKç‰ˆæœ¬

## å®‰å…¨æ³¨æ„äº‹é¡¹

1. **ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²**:
   - ä¿®æ”¹ `app.secret_key`
   - æ›´æ”¹ç®¡ç†å‘˜å¯†ç 
   - é…ç½®HTTPS
   - è®¾ç½®æ–‡ä»¶ä¸Šä¼ é™åˆ¶

2. **æ–‡ä»¶å®‰å…¨**:
   - ä¸Šä¼ çš„å›¾ç‰‡å­˜å‚¨åœ¨ `uploads/` ç›®å½•
   - æ”¯æŒçš„æ–‡ä»¶æ ¼å¼: png, jpg, jpeg, gif, webp
   - æœ€å¤§æ–‡ä»¶å¤§å°: 16MB

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•ä¿®æ”¹ç®¡ç†å‘˜å¯†ç ï¼Ÿ
A: åœ¨ `app.py` æ–‡ä»¶ä¸­ä¿®æ”¹ `ADMIN_PASSWORD` å˜é‡ã€‚

### Q: å¦‚ä½•æ›´æ”¹ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶ï¼Ÿ
A: åœ¨ `app.py` ä¸­ä¿®æ”¹ `MAX_CONTENT_LENGTH` é…ç½®ã€‚

### Q: å¦‚ä½•å¤‡ä»½æ•°æ®ï¼Ÿ
A: å¤åˆ¶ `feedback.db` æ–‡ä»¶å³å¯å¤‡ä»½æ‰€æœ‰æ•°æ®ã€‚

### Q: å¦‚ä½•éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼Ÿ
A: ä½¿ç”¨ Gunicorn æˆ– uWSGI ç­‰WSGIæœåŠ¡å™¨ï¼Œé…ç½®Nginxåå‘ä»£ç†ã€‚

### Q: å¦‚ä½•æµ‹è¯•APKç‰ˆæœ¬ç®¡ç†åŠŸèƒ½ï¼Ÿ
A: è¿è¡Œ `python test_apk_api.py` è„šæœ¬æµ‹è¯•APKç‰ˆæœ¬æ£€æŸ¥APIã€‚

### Q: å¦‚ä½•æ·»åŠ APKç‰ˆæœ¬ï¼Ÿ
A: ç™»å½•ç®¡ç†å‘˜é¢æ¿ï¼Œç‚¹å‡»"æ·»åŠ APKç‰ˆæœ¬"æŒ‰é’®ï¼Œå¡«å†™ç‰ˆæœ¬å·ã€æ›´æ–°è¯´æ˜å’Œä¸‹è½½é“¾æ¥ã€‚

### Q: APKæ–‡ä»¶å¦‚ä½•ç®¡ç†ï¼Ÿ
A: ç®¡ç†å‘˜åªéœ€è¦æä¾›APKçš„ä¸‹è½½é“¾æ¥ï¼Œç³»ç»Ÿä¸å­˜å‚¨APKæ–‡ä»¶æœ¬èº«ï¼Œç®€åŒ–äº†ç®¡ç†æµç¨‹ã€‚

## Androidåº”ç”¨é›†æˆæŒ‡å—

### åœ¨Androidåº”ç”¨ä¸­é›†æˆåé¦ˆåŠŸèƒ½

#### 1. æ·»åŠ ç½‘ç»œæƒé™
åœ¨ `AndroidManifest.xml` ä¸­æ·»åŠ ç½‘ç»œæƒé™ï¼š
```xml
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
```

#### 2. æ·»åŠ ä¾èµ–åº“
åœ¨ `build.gradle` (Module: app) ä¸­æ·»åŠ ï¼š
```gradle
dependencies {
    implementation 'com.squareup.okhttp3:okhttp:4.10.0'
    implementation 'com.squareup.okhttp3:logging-interceptor:4.10.0'
    implementation 'com.google.code.gson:gson:2.10.1'
}
```

#### 3. åˆ›å»ºåé¦ˆæ•°æ®ç±»
```kotlin
data class FeedbackData(
    val id: String,
    val time: String,
    val feedback: String,
    val images: List<String> = emptyList()
)
```

#### 4. åˆ›å»ºAPIæœåŠ¡ç±»
```kotlin
import okhttp3.*
import okhttp3.MediaType.Companion.toMediaType
import okhttp3.RequestBody.Companion.asRequestBody
import okhttp3.RequestBody.Companion.toRequestBody
import java.io.File
import java.text.SimpleDateFormat
import java.util.*

class FeedbackApiService {
    private val client = OkHttpClient()
    private val baseUrl = "https://app.mspa.shop"
    
    fun submitFeedback(
        userId: String,
        feedback: String,
        images: List<File>? = null,
        callback: (Boolean, String) -> Unit
    ) {
        try {
            val formBuilder = MultipartBody.Builder()
                .setType(MultipartBody.FORM)
                .addFormDataPart("id", userId)
                .addFormDataPart("time", getCurrentTime())
                .addFormDataPart("feedback", feedback)
            
            // æ·»åŠ å›¾ç‰‡
            images?.forEach { imageFile ->
                val requestFile = imageFile.asRequestBody("image/*".toMediaType())
                formBuilder.addFormDataPart(
                    "images",
                    imageFile.name,
                    requestFile
                )
            }
            
            val requestBody = formBuilder.build()
            
            val request = Request.Builder()
                .url("$baseUrl/api/feedback")
                .post(requestBody)
                .build()
            
            client.newCall(request).enqueue(object : Callback {
                override fun onFailure(call: Call, e: IOException) {
                    callback(false, "ç½‘ç»œé”™è¯¯: ${e.message}")
                }
                
                override fun onResponse(call: Call, response: Response) {
                    val responseBody = response.body?.string() ?: ""
                    if (response.isSuccessful) {
                        callback(true, "åé¦ˆæäº¤æˆåŠŸ")
                    } else {
                        callback(false, "æäº¤å¤±è´¥: $responseBody")
                    }
                }
            })
        } catch (e: Exception) {
            callback(false, "æäº¤å¼‚å¸¸: ${e.message}")
        }
    }
    
    private fun getCurrentTime(): String {
        val sdf = SimpleDateFormat("yyyy-MM-dd HH:mm:ss", Locale.getDefault())
        return sdf.format(Date())
    }
}
```

#### 5. åœ¨Activityä¸­ä½¿ç”¨
```kotlin
class FeedbackActivity : AppCompatActivity() {
    private val apiService = FeedbackApiService()
    private val selectedImages = mutableListOf<File>()
    
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_feedback)
        
        // è®¾ç½®æäº¤æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        submitButton.setOnClickListener {
            submitFeedback()
        }
        
        // è®¾ç½®å›¾ç‰‡é€‰æ‹©æŒ‰é’®
        selectImageButton.setOnClickListener {
            selectImages()
        }
    }
    
    private fun submitFeedback() {
        val userId = userIdEditText.text.toString()
        val feedback = feedbackEditText.text.toString()
        
        if (userId.isEmpty() || feedback.isEmpty()) {
            Toast.makeText(this, "è¯·å¡«å†™å®Œæ•´ä¿¡æ¯", Toast.LENGTH_SHORT).show()
            return
        }
        
        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        submitButton.isEnabled = false
        submitButton.text = "æäº¤ä¸­..."
        
        apiService.submitFeedback(
            userId = userId,
            feedback = feedback,
            images = selectedImages.takeIf { it.isNotEmpty() }
        ) { success, message ->
            runOnUiThread {
                submitButton.isEnabled = true
                submitButton.text = "æäº¤åé¦ˆ"
                
                if (success) {
                    Toast.makeText(this, message, Toast.LENGTH_SHORT).show()
                    // æ¸…ç©ºè¡¨å•
                    feedbackEditText.text.clear()
                    selectedImages.clear()
                    updateImagePreview()
                } else {
                    Toast.makeText(this, message, Toast.LENGTH_LONG).show()
                }
            }
        }
    }
    
    private fun selectImages() {
        // ä½¿ç”¨å›¾ç‰‡é€‰æ‹©åº“ï¼Œå¦‚ ImagePicker
        // è¿™é‡Œä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„å›¾ç‰‡é€‰æ‹©å™¨
        val intent = Intent(Intent.ACTION_GET_CONTENT)
        intent.type = "image/*"
        intent.putExtra(Intent.EXTRA_ALLOW_MULTIPLE, true)
        startActivityForResult(intent, REQUEST_CODE_SELECT_IMAGES)
    }
    
    override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {
        super.onActivityResult(requestCode, resultCode, data)
        
        if (requestCode == REQUEST_CODE_SELECT_IMAGES && resultCode == RESULT_OK) {
            data?.let { intent ->
                val clipData = intent.clipData
                if (clipData != null) {
                    // å¤šé€‰å›¾ç‰‡
                    for (i in 0 until clipData.itemCount) {
                        val uri = clipData.getItemAt(i).uri
                        val file = File(uri.path ?: "")
                        selectedImages.add(file)
                    }
                } else {
                    // å•é€‰å›¾ç‰‡
                    intent.data?.let { uri ->
                        val file = File(uri.path ?: "")
                        selectedImages.add(file)
                    }
                }
                updateImagePreview()
            }
        }
    }
    
    private fun updateImagePreview() {
        // æ›´æ–°å›¾ç‰‡é¢„è§ˆUI
        // æ˜¾ç¤ºé€‰ä¸­çš„å›¾ç‰‡æ•°é‡å’Œç¼©ç•¥å›¾
    }
    
    companion object {
        private const val REQUEST_CODE_SELECT_IMAGES = 1001
    }
}
```

#### 6. æ·»åŠ å›¾ç‰‡å‹ç¼©åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰
```kotlin
import android.graphics.Bitmap
import android.graphics.BitmapFactory
import java.io.File
import java.io.FileOutputStream

class ImageUtils {
    companion object {
        fun compressImage(inputFile: File, maxSizeKB: Int = 500): File {
            val bitmap = BitmapFactory.decodeFile(inputFile.absolutePath)
            
            var quality = 100
            var outputStream: FileOutputStream
            
            do {
                val outputFile = File(inputFile.parent, "compressed_${inputFile.name}")
                outputStream = FileOutputStream(outputFile)
                bitmap.compress(Bitmap.CompressFormat.JPEG, quality, outputStream)
                outputStream.close()
                quality -= 10
            } while (outputFile.length() > maxSizeKB * 1024 && quality > 10)
            
            return outputFile
        }
    }
}
```

#### 7. å®Œæ•´çš„å¸ƒå±€æ–‡ä»¶ç¤ºä¾‹
```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:padding="16dp">

    <EditText
        android:id="@+id/userIdEditText"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:hint="ç”¨æˆ·ID"
        android:inputType="text" />

    <EditText
        android:id="@+id/feedbackEditText"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:gravity="top"
        android:hint="è¯·è¾“å…¥åé¦ˆå†…å®¹..."
        android:inputType="textMultiLine"
        android:minLines="5" />

    <Button
        android:id="@+id/selectImageButton"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="é€‰æ‹©å›¾ç‰‡ (æœ€å¤š2å¼ )" />

    <TextView
        android:id="@+id/imageCountText"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="å·²é€‰æ‹© 0 å¼ å›¾ç‰‡"
        android:visibility="gone" />

    <Button
        android:id="@+id/submitButton"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="æäº¤åé¦ˆ" />

</LinearLayout>
```

### æµ‹è¯•Androidåº”ç”¨
1. åœ¨æ¨¡æ‹Ÿå™¨æˆ–çœŸæœºä¸Šè¿è¡Œåº”ç”¨
2. å¡«å†™ç”¨æˆ·IDå’Œåé¦ˆå†…å®¹
3. é€‰æ‹©1-2å¼ å›¾ç‰‡ï¼ˆå¯é€‰ï¼‰
4. ç‚¹å‡»æäº¤æŒ‰é’®
5. æ£€æŸ¥æœåŠ¡å™¨ç«¯æ˜¯å¦æ”¶åˆ°æ•°æ®

### Androidå¼€å‘æœ€ä½³å®è·µ

#### ç½‘ç»œè¯·æ±‚ä¼˜åŒ–
```kotlin
// æ·»åŠ ç½‘ç»œè¶…æ—¶è®¾ç½®
private val client = OkHttpClient.Builder()
    .connectTimeout(30, TimeUnit.SECONDS)
    .readTimeout(30, TimeUnit.SECONDS)
    .writeTimeout(30, TimeUnit.SECONDS)
    .build()
```

#### å›¾ç‰‡å¤„ç†ä¼˜åŒ–
```kotlin
// å›¾ç‰‡å‹ç¼©å’Œæ ¼å¼è½¬æ¢
fun compressAndResizeImage(file: File): File {
    val bitmap = BitmapFactory.decodeFile(file.absolutePath)
    val resizedBitmap = Bitmap.createScaledBitmap(bitmap, 800, 600, true)
    
    val outputFile = File(file.parent, "compressed_${file.name}")
    val outputStream = FileOutputStream(outputFile)
    resizedBitmap.compress(Bitmap.CompressFormat.JPEG, 80, outputStream)
    outputStream.close()
    
    return outputFile
}
```

#### é”™è¯¯å¤„ç†
```kotlin
// æ·»åŠ è¯¦ç»†çš„é”™è¯¯å¤„ç†
apiService.submitFeedback(userId, feedback, images) { success, message ->
    runOnUiThread {
        when {
            success -> {
                Toast.makeText(this, "åé¦ˆæäº¤æˆåŠŸ", Toast.LENGTH_SHORT).show()
                // æ¸…ç©ºè¡¨å•
                clearForm()
            }
            message.contains("ç½‘ç»œé”™è¯¯") -> {
                Toast.makeText(this, "ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®", Toast.LENGTH_LONG).show()
            }
            message.contains("è¶…æ—¶") -> {
                Toast.makeText(this, "è¯·æ±‚è¶…æ—¶ï¼Œè¯·é‡è¯•", Toast.LENGTH_SHORT).show()
            }
            else -> {
                Toast.makeText(this, "æäº¤å¤±è´¥: $message", Toast.LENGTH_LONG).show()
            }
        }
    }
}
```

#### ç”¨æˆ·ä½“éªŒä¼˜åŒ–
```kotlin
// æ·»åŠ è¿›åº¦æŒ‡ç¤ºå™¨
private fun showProgressDialog() {
    progressDialog = ProgressDialog(this)
    progressDialog?.setMessage("æ­£åœ¨æäº¤åé¦ˆ...")
    progressDialog?.setCancelable(false)
    progressDialog?.show()
}

private fun hideProgressDialog() {
    progressDialog?.dismiss()
    progressDialog = null
}

// è¡¨å•éªŒè¯
private fun validateForm(): Boolean {
    val userId = userIdEditText.text.toString().trim()
    val feedback = feedbackEditText.text.toString().trim()
    
    when {
        userId.isEmpty() -> {
            userIdEditText.error = "è¯·è¾“å…¥ç”¨æˆ·ID"
            return false
        }
        feedback.isEmpty() -> {
            feedbackEditText.error = "è¯·è¾“å…¥åé¦ˆå†…å®¹"
            return false
        }
        feedback.length < 10 -> {
            feedbackEditText.error = "åé¦ˆå†…å®¹è‡³å°‘10ä¸ªå­—ç¬¦"
            return false
        }
        selectedImages.size > 2 -> {
            Toast.makeText(this, "æœ€å¤šåªèƒ½é€‰æ‹©2å¼ å›¾ç‰‡", Toast.LENGTH_SHORT).show()
            return false
        }
    }
    return true
}
```

### Androidé¡¹ç›®ç»“æ„å»ºè®®
```
app/src/main/java/com/yourpackage/
â”œâ”€â”€ ui/
â”‚   â””â”€â”€ feedback/
â”‚       â”œâ”€â”€ FeedbackActivity.kt
â”‚       â””â”€â”€ FeedbackViewModel.kt
â”œâ”€â”€ network/
â”‚   â”œâ”€â”€ FeedbackApiService.kt
â”‚   â””â”€â”€ ApiConstants.kt
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ ImageUtils.kt
â”‚   â””â”€â”€ NetworkUtils.kt
â””â”€â”€ data/
    â””â”€â”€ FeedbackData.kt
```

### æƒé™é…ç½®
åœ¨ `AndroidManifest.xml` ä¸­æ·»åŠ å®Œæ•´æƒé™ï¼š
```xml
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.CAMERA" />

<!-- å¦‚æœéœ€è¦ä»ç›¸å†Œé€‰æ‹©å›¾ç‰‡ -->
<uses-permission android:name="android.permission.READ_MEDIA_IMAGES" />
```

## å¼€å‘è¯´æ˜

### æ·»åŠ æ–°åŠŸèƒ½
1. åœ¨ `app.py` ä¸­æ·»åŠ è·¯ç”±
2. åœ¨ `templates/` ä¸­åˆ›å»ºå¯¹åº”çš„HTMLæ¨¡æ¿
3. åœ¨ `static/` ä¸­æ·»åŠ CSSå’ŒJavaScript

### è‡ªå®šä¹‰æ ·å¼
- ä¿®æ”¹ `static/style.css` æ–‡ä»¶
- ä½¿ç”¨Bootstrap 5çš„CSSç±»
- æ”¯æŒå“åº”å¼è®¾è®¡

## è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œä¸ªäººä½¿ç”¨ã€‚

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»å¼€å‘è€…ã€‚

---

**æ³¨æ„**: é¦–æ¬¡è¿è¡Œæ—¶ä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“å’Œä¸Šä¼ æ–‡ä»¶å¤¹ï¼Œæ— éœ€æ‰‹åŠ¨åˆ›å»ºã€‚
